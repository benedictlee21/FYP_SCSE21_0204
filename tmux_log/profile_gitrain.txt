     CHECK_INPUT(new_xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:20: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                    ^
src/ball_query.cpp:11:29: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CONTIGUOUS(x) AT_CHECK(x.is_contiguous(), #x, " must be contiguous ")
                             ^
src/ball_query.cpp:12:38: ??:in expansion of macro 'CHECK_CONTIGUOUS'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                                      ^
src/ball_query.cpp:16:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(new_xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:40: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                                        ^
src/ball_query.cpp:11:29: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CONTIGUOUS(x) AT_CHECK(x.is_contiguous(), #x, " must be contiguous ")
                             ^
src/ball_query.cpp:12:38: ??:in expansion of macro 'CHECK_CONTIGUOUS'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                                      ^
src/ball_query.cpp:16:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(new_xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:20: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                    ^
src/ball_query.cpp:10:23: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CUDA(x) AT_CHECK(x.type().is_cuda(), #x, " must be a CUDAtensor ")
                       ^
src/ball_query.cpp:12:24: ??:in expansion of macro 'CHECK_CUDA'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                        ^
src/ball_query.cpp:17:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:20: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                    ^
src/ball_query.cpp:10:23: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CUDA(x) AT_CHECK(x.type().is_cuda(), #x, " must be a CUDAtensor ")
                       ^
src/ball_query.cpp:12:24: ??:in expansion of macro 'CHECK_CUDA'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                        ^
src/ball_query.cpp:17:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:40: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                                        ^
src/ball_query.cpp:10:23: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CUDA(x) AT_CHECK(x.type().is_cuda(), #x, " must be a CUDAtensor ")
                       ^
src/ball_query.cpp:12:24: ??:in expansion of macro 'CHECK_CUDA'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                        ^
src/ball_query.cpp:17:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:20: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                    ^
src/ball_query.cpp:11:29: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CONTIGUOUS(x) AT_CHECK(x.is_contiguous(), #x, " must be contiguous ")
                             ^
src/ball_query.cpp:12:38: ??:in expansion of macro 'CHECK_CONTIGUOUS'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                                      ^
src/ball_query.cpp:17:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:20: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                    ^
src/ball_query.cpp:11:29: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CONTIGUOUS(x) AT_CHECK(x.is_contiguous(), #x, " must be contiguous ")
                             ^
src/ball_query.cpp:12:38: ??:in expansion of macro 'CHECK_CONTIGUOUS'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                                      ^
src/ball_query.cpp:17:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
39:40: ??:'void c10::detail::deprecated_AT_CHECK()' is deprecated [-Wdeprecated-declarations]
     ::c10::detail::deprecated_AT_CHECK();                 \
                                        ^
src/ball_query.cpp:11:29: ??:in expansion of macro 'AT_CHECK'
 #define CHECK_CONTIGUOUS(x) AT_CHECK(x.is_contiguous(), #x, " must be contiguous ")
                             ^
src/ball_query.cpp:12:38: ??:in expansion of macro 'CHECK_CONTIGUOUS'
 #define CHECK_INPUT(x) CHECK_CUDA(x);CHECK_CONTIGUOUS(x)
                                      ^
src/ball_query.cpp:17:5: ??:in expansion of macro 'CHECK_INPUT'
     CHECK_INPUT(xyz_tensor);
     ^
In file included from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
c10/core/Device.h:5:0,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/input-archive.h:4,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/archive.h:3,
                 from /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
torch/csrc/api/include/torch/serialize/tensor.h:3,
                 from src/ball_query.cpp:1:
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/c10/util/Exception.h:3
14:13: ??:????
 inline void deprecated_AT_CHECK() {}
             ^
/mnt/lustre/share/cuda-10.0/bin/nvcc -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packag
es/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/tor
ch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/THC -I/mnt/lustre
/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m -c src/ball_query_
gpu.cu -o build/temp.linux-x86_64-3.7/src/ball_query_gpu.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CO
NVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O2 -DTORCH_A
PI_INCLUDE_EXTENSION_H -DTORCH_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
<built-in>(1): warning: support for trigraphs is disabled

<built-in>(1): warning: support for trigraphs is disabled

gcc -pthread -B /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/compiler_compat -Wl,--sysroot=/ -Wsign-compare -
DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/pyt
hon3.7/site-packages/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages
/torch/include/torch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packa
ges/torch/include/TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include
/THC -I/mnt/lustre/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m
-c src/group_points.cpp -o build/temp.linux-x86_64-3.7/src/group_points.o -g -DTORCH_API_INCLUDE_EXTENSION_
H -DTORCH_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
cc1plus: ??:command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
/mnt/lustre/share/cuda-10.0/bin/nvcc -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packag
es/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/tor
ch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/THC -I/mnt/lustre
/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m -c src/group_point
s_gpu.cu -o build/temp.linux-x86_64-3.7/src/group_points_gpu.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HAL
F_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O2 -DTOR
CH_API_INCLUDE_EXTENSION_H -DTORCH_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
<built-in>(1): warning: support for trigraphs is disabled

<built-in>(1): warning: support for trigraphs is disabled

gcc -pthread -B /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/compiler_compat -Wl,--sysroot=/ -Wsign-compare -
DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/pyt
hon3.7/site-packages/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages
/torch/include/torch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packa
ges/torch/include/TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include
/THC -I/mnt/lustre/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m
-c src/interpolate.cpp -o build/temp.linux-x86_64-3.7/src/interpolate.o -g -DTORCH_API_INCLUDE_EXTENSION_H
-DTORCH_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
cc1plus: ??:command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
/mnt/lustre/share/cuda-10.0/bin/nvcc -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packag
es/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/tor
ch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/THC -I/mnt/lustre
/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m -c src/interpolate
_gpu.cu -o build/temp.linux-x86_64-3.7/src/interpolate_gpu.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_
CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O2 -DTORCH
_API_INCLUDE_EXTENSION_H -DTORCH_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
<built-in>(1): warning: support for trigraphs is disabled

<built-in>(1): warning: support for trigraphs is disabled

gcc -pthread -B /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/compiler_compat -Wl,--sysroot=/ -Wsign-compare -
DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/pyt
hon3.7/site-packages/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages
/torch/include/torch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packa
ges/torch/include/TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include
/THC -I/mnt/lustre/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m
-c src/sampling.cpp -o build/temp.linux-x86_64-3.7/src/sampling.o -g -DTORCH_API_INCLUDE_EXTENSION_H -DTORC
H_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
cc1plus: ??:command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
/mnt/lustre/share/cuda-10.0/bin/nvcc -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packag
es/torch/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/tor
ch/csrc/api/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/
TH -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/include/THC -I/mnt/lustre
/share/cuda-10.0/include -I/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/include/python3.7m -c src/sampling_gp
u.cu -o build/temp.linux-x86_64-3.7/src/sampling_gpu.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVER
SIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options '-fPIC' -O2 -DTORCH_API_I
NCLUDE_EXTENSION_H -DTORCH_EXTENSION_NAME=pointnet2_cuda -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++11
<built-in>(1): warning: support for trigraphs is disabled

<built-in>(1): warning: support for trigraphs is disabled

creating build/lib.linux-x86_64-3.7
g++ -pthread -shared -B /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/compiler_compat -L/mnt/lustre/zhangjunzh
e/anaconda3/envs/msn/lib -Wl,-rpath=/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib -Wl,--no-as-needed -Wl,-
-sysroot=/ build/temp.linux-x86_64-3.7/src/pointnet2_api.o build/temp.linux-x86_64-3.7/src/ball_query.o bui
ld/temp.linux-x86_64-3.7/src/ball_query_gpu.o build/temp.linux-x86_64-3.7/src/group_points.o build/temp.lin
ux-x86_64-3.7/src/group_points_gpu.o build/temp.linux-x86_64-3.7/src/interpolate.o build/temp.linux-x86_64-
3.7/src/interpolate_gpu.o build/temp.linux-x86_64-3.7/src/sampling.o build/temp.linux-x86_64-3.7/src/sampli
ng_gpu.o -L/mnt/lustre/share/cuda-10.0/lib64 -lcudart -o build/lib.linux-x86_64-3.7/pointnet2_cuda.cpython-
37m-x86_64-linux-gnu.so
creating build/bdist.linux-x86_64
creating build/bdist.linux-x86_64/egg
copying build/lib.linux-x86_64-3.7/pointnet2_cuda.cpython-37m-x86_64-linux-gnu.so -> build/bdist.linux-x86_
64/egg
creating stub loader for pointnet2_cuda.cpython-37m-x86_64-linux-gnu.so
byte-compiling build/bdist.linux-x86_64/egg/pointnet2_cuda.py to pointnet2_cuda.cpython-37.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying pointnet2.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying pointnet2.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying pointnet2.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying pointnet2.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
writing build/bdist.linux-x86_64/egg/EGG-INFO/native_libs.txt
zip_safe flag not set; analyzing archive contents...
__pycache__.pointnet2_cuda.cpython-37: module references __file__
creating dist
creating 'dist/pointnet2-0.0.0-py3.7-linux-x86_64.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing pointnet2-0.0.0-py3.7-linux-x86_64.egg
creating /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/pointnet2-0.0.0-py3.7-linux
-x86_64.egg
Extracting pointnet2-0.0.0-py3.7-linux-x86_64.egg to /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3
.7/site-packages
Adding pointnet2 0.0.0 to easy-install.pth file

Installed /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/pointnet2-0.0.0-py3.7-linu
x-x86_64.egg
Processing dependencies for pointnet2==0.0.0
Finished processing dependencies for pointnet2==0.0.0
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pointnet2]$ cd ../../..
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ ;s
-bash: 未预期的符号 `;' 附近有语法错误
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ ls
__pycache__  data  main.py  models  run.sh  test.py  train  utils
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name topnet --load_m
odel /mnt/lustre/share/zhangjunzhe/xinyi/log

Input_size:  torch.Size([20, 8192, 3])
Runtime: 0.273091s
EMD: 0.046589
|set(assignment)|: 8192
Verified EMD: 0.046589
Jitting Chamfer 3D
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/cpp_extension.py:171: Us
erWarning:

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  platform=sys.platform))
Loaded JIT 3D CUDA chamfer distance
Traceback (most recent call last):
  File "main.py", line 46, in <module>
    test(args)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/test.py", line 25, in test
    dataset_test = ShapeNetH5(train=False, npoints=args.num_points, use_mean_feature=args.use_mean_feature)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/data/dataset.py", line 19, in __init__
    input_file = h5py.File(self.input_path, 'r')
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/h5py/_hl/files.py", line 408
, in __init__
    swmr=swmr)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/h5py/_hl/files.py", line 173
, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 88, in h5py.h5f.open
OSError: Unable to open file (unable to open file: name = '/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/da
ta/cascade/test_data.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name topnet --load_m
odel /mnt/lustre/share/zhangjunzhe/xinyi/log
Input_size:  torch.Size([20, 8192, 3])
Runtime: 0.284285s
EMD: 0.046449
|set(assignment)|: 8192
Verified EMD: 0.046449
Jitting Chamfer 3D
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/cpp_extension.py:171: Us
erWarning:

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  platform=sys.platform))
Loaded JIT 3D CUDA chamfer distance
best_emd_network.pth
Traceback (most recent call last):
  File "main.py", line 46, in <module>
    test(args)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/test.py", line 44, in test
    load_model(args, net, None, log_test, train=False)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/utils/utils.py", line 131, in load_model
    ckpt = torch.load(ckpt_path)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/serialization.py", lin
e 381, in load
    f = open(f, 'rb')
IsADirectoryError: [Errno 21] Is a directory: '/mnt/lustre/share/zhangjunzhe/xinyi/log'
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name topnet --load_m
odel /mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/pretrained_models/topnet/best_cd_t_network.pth
Input_size:  torch.Size([20, 8192, 3])
Runtime: 0.282337s
EMD: 0.046345
|set(assignment)|: 8192
Verified EMD: 0.046345
Jitting Chamfer 3D
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/cpp_extension.py:171: Us
erWarning:

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  platform=sys.platform))
Loaded JIT 3D CUDA chamfer distance
best_emd_network.pth
topnet's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 107.687042, CD_t: 4.080894, EMD: 400.223999 F1: 0.964603
CD_p: 206.683609, CD_t: 12.903502, EMD: 833.144409 F1: 0.859007
CD_p: 171.125488, CD_t: 7.843184, EMD: 424.646545 F1: 0.926880
CD_p: 205.815674, CD_t: 13.383398, EMD: 718.681885 F1: 0.842604
CD_p: 209.583832, CD_t: 14.769118, EMD: 1373.435303 F1: 0.812946
CD_p: 220.817917, CD_t: 16.046095, EMD: 669.041077 F1: 0.830220
CD_p: 187.952820, CD_t: 12.853309, EMD: 756.851746 F1: 0.871465
CD_p: 167.214050, CD_t: 8.928002, EMD: 481.606842 F1: 0.905054
Overview results:
CD_p: 0.018461, CD_t: 0.001135, EMD: 0.070720 F1: 0.876597
best_cd_p_network.pth
topnet's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 107.687042, CD_t: 4.080894, EMD: 400.189056 F1: 0.964603
CD_p: 206.683609, CD_t: 12.903502, EMD: 833.360352 F1: 0.859007
CD_p: 171.125488, CD_t: 7.843184, EMD: 424.779205 F1: 0.926880
CD_p: 205.815674, CD_t: 13.383398, EMD: 718.689514 F1: 0.842604
CD_p: 209.583832, CD_t: 14.769118, EMD: 1374.585815 F1: 0.812946
CD_p: 220.817917, CD_t: 16.046095, EMD: 669.076538 F1: 0.830220
CD_p: 187.952820, CD_t: 12.853309, EMD: 756.705872 F1: 0.871465
CD_p: 167.214050, CD_t: 8.928002, EMD: 481.540192 F1: 0.905054
Overview results:
CD_p: 0.018461, CD_t: 0.001135, EMD: 0.070737 F1: 0.876597
best_cd_t_network.pth
topnet's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 107.687042, CD_t: 4.080894, EMD: 400.195679 F1: 0.964603
CD_p: 206.683609, CD_t: 12.903502, EMD: 833.261230 F1: 0.859007
CD_p: 171.125488, CD_t: 7.843184, EMD: 424.780731 F1: 0.926880
CD_p: 205.815674, CD_t: 13.383398, EMD: 718.814209 F1: 0.842604
CD_p: 209.583832, CD_t: 14.769118, EMD: 1373.806274 F1: 0.812946
CD_p: 220.817917, CD_t: 16.046095, EMD: 669.184387 F1: 0.830220
CD_p: 187.952820, CD_t: 12.853309, EMD: 756.624817 F1: 0.871465
CD_p: 167.214050, CD_t: 8.928002, EMD: 481.567719 F1: 0.905054
Overview results:
CD_p: 0.018461, CD_t: 0.001135, EMD: 0.070728 F1: 0.876597
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ clear
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name cascade --load_
model /mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/pretrained_models/cascade/best_cd_t_network.pth
Traceback (most recent call last):
  File "main.py", line 2, in <module>
    from test import test
  File "/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/test.py", line 48
    pcd_file = h5py.File(os.path.join(args.model_dir, 'outputs', args.model_name '%s_pcds.h5' % epoch.split
('.')[0]), 'w')
                                                                                            ^
SyntaxError: invalid syntax
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name cascade --load_
model /mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/pretrained_models/cascade/best_cd_t_network.pth
Input_size:  torch.Size([20, 8192, 3])
Runtime: 0.286830s
EMD: 0.046527
|set(assignment)|: 8192
Verified EMD: 0.046527
Jitting Chamfer 3D
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/cpp_extension.py:171: Us
erWarning:

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  platform=sys.platform))
Loaded JIT 3D CUDA chamfer distance
best_emd_network.pth
Traceback (most recent call last):
  File "main.py", line 46, in <module>
    test(args)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/test.py", line 34, in test
    net = CascadeGenerator(step_ratio=args.step_ratio)
NameError: name 'CascadeGenerator' is not defined
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name cascade --load_
model /mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/pretrained_models/cascade/best_cd_t_network.pth
Input_size:  torch.Size([20, 8192, 3])
Runtime: 0.296698s
EMD: 0.046601
|set(assignment)|: 8192
Verified EMD: 0.046601
Jitting Chamfer 3D
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/cpp_extension.py:171: Us
erWarning:

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  platform=sys.platform))
Loaded JIT 3D CUDA chamfer distance
best_emd_network.pth
cascade's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 81.701836, CD_t: 2.322874, EMD: 384.439117 F1: 0.984965
CD_p: 192.403549, CD_t: 11.405041, EMD: 700.012207 F1: 0.876978
CD_p: 151.856613, CD_t: 6.183953, EMD: 675.943787 F1: 0.947605
CD_p: 165.131241, CD_t: 8.783689, EMD: 596.024841 F1: 0.908936
CD_p: 146.591599, CD_t: 8.459317, EMD: 960.148193 F1: 0.911304
CD_p: 191.974838, CD_t: 11.295092, EMD: 743.261414 F1: 0.869575
CD_p: 154.364075, CD_t: 9.302735, EMD: 504.577454 F1: 0.936622
CD_p: 131.780045, CD_t: 6.050670, EMD: 556.539795 F1: 0.948846
Overview results:
CD_p: 0.015198, CD_t: 0.000798, EMD: 0.064012 F1: 0.923104
best_cd_p_network.pth
cascade's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 81.701836, CD_t: 2.322874, EMD: 384.505554 F1: 0.984965
CD_p: 192.403549, CD_t: 11.405041, EMD: 699.912231 F1: 0.876978
CD_p: 151.856613, CD_t: 6.183953, EMD: 675.717285 F1: 0.947605
CD_p: 165.131241, CD_t: 8.783689, EMD: 595.955505 F1: 0.908936
CD_p: 146.591599, CD_t: 8.459317, EMD: 960.214966 F1: 0.911304
CD_p: 191.974838, CD_t: 11.295092, EMD: 743.464111 F1: 0.869575
CD_p: 154.364075, CD_t: 9.302735, EMD: 504.533661 F1: 0.936622
CD_p: 131.780045, CD_t: 6.050670, EMD: 556.672974 F1: 0.948846
Overview results:
CD_p: 0.015198, CD_t: 0.000798, EMD: 0.064012 F1: 0.923104
best_cd_t_network.pth
cascade's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 81.701836, CD_t: 2.322874, EMD: 384.408417 F1: 0.984965
CD_p: 192.403549, CD_t: 11.405041, EMD: 700.039490 F1: 0.876978
CD_p: 151.856613, CD_t: 6.183953, EMD: 675.943359 F1: 0.947605
CD_p: 165.131241, CD_t: 8.783689, EMD: 595.954529 F1: 0.908936
CD_p: 146.591599, CD_t: 8.459317, EMD: 960.089722 F1: 0.911304
CD_p: 191.974838, CD_t: 11.295092, EMD: 743.476685 F1: 0.869575
CD_p: 154.364075, CD_t: 9.302735, EMD: 504.569275 F1: 0.936622
CD_p: 131.780045, CD_t: 6.050670, EMD: 556.531311 F1: 0.948846
Overview results:
CD_p: 0.015198, CD_t: 0.000798, EMD: 0.064013 F1: 0.923104
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ python main.py --mode 1 --model_name msn --load_mode
l /mnt/lustre/zhangjunzhe/pcd_lib/pcd_benchmark/pretrained_models/msn/best_cd_t_network.pth
Input_size:  torch.Size([20, 8192, 3])
Runtime: 0.525805s
EMD: 0.046444
|set(assignment)|: 8192
Verified EMD: 0.046444
Jitting Chamfer 3D
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/cpp_extension.py:171: Us
erWarning:

                               !! WARNING !!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Your compiler (c++) is not compatible with the compiler Pytorch was
built with for this platform, which is g++ on linux. Please
use g++ to to compile your extension. Alternatively, you may
compile PyTorch from source using c++, and then you can also use
c++ to compile your extension.

See https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md for help
with compiling PyTorch from source.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

                              !! WARNING !!

  platform=sys.platform))
Loaded JIT 3D CUDA chamfer distance
best_emd_network.pth
msn's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 91.555847, CD_t: 2.897383, EMD: 327.465057 F1: 0.977360
CD_p: 199.335403, CD_t: 12.615752, EMD: 556.217224 F1: 0.870757
CD_p: 162.220612, CD_t: 7.098793, EMD: 398.030396 F1: 0.936199
CD_p: 180.742157, CD_t: 10.584576, EMD: 511.255829 F1: 0.882729
CD_p: 155.298203, CD_t: 9.228460, EMD: 645.473999 F1: 0.897137
CD_p: 201.666870, CD_t: 12.041852, EMD: 614.958496 F1: 0.852006
CD_p: 163.247513, CD_t: 9.665659, EMD: 482.988037 F1: 0.922214
CD_p: 142.628159, CD_t: 6.541390, EMD: 414.354462 F1: 0.939618
Overview results:
CD_p: 0.016209, CD_t: 0.000883, EMD: 0.049384 F1: 0.909753
best_cd_p_network.pth
msn's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 91.632347, CD_t: 2.922751, EMD: 327.474365 F1: 0.977458
CD_p: 199.117844, CD_t: 12.539229, EMD: 556.204773 F1: 0.871253
CD_p: 162.374695, CD_t: 7.126616, EMD: 400.177429 F1: 0.935395
CD_p: 180.820282, CD_t: 10.605940, EMD: 513.234314 F1: 0.883339
CD_p: 155.656754, CD_t: 9.263876, EMD: 645.713379 F1: 0.896371
CD_p: 201.221115, CD_t: 11.984087, EMD: 613.737427 F1: 0.853275
CD_p: 163.210144, CD_t: 9.613770, EMD: 482.741455 F1: 0.921850
CD_p: 142.549026, CD_t: 6.524759, EMD: 412.503082 F1: 0.939705
Overview results:
CD_p: 0.016207, CD_t: 0.000882, EMD: 0.049397 F1: 0.909831
best_cd_t_network.pth
msn's weight loaded.
Testing...
test [0/150]
test [100/150]
CD_p: 91.525856, CD_t: 2.902933, EMD: 327.387665 F1: 0.977357
CD_p: 199.312012, CD_t: 12.550333, EMD: 558.219849 F1: 0.870348
CD_p: 162.445877, CD_t: 7.113406, EMD: 399.877899 F1: 0.935785
CD_p: 181.011368, CD_t: 10.640997, EMD: 511.379761 F1: 0.883251
CD_p: 155.305130, CD_t: 9.226455, EMD: 645.540710 F1: 0.896733
CD_p: 201.358032, CD_t: 12.029704, EMD: 613.833191 F1: 0.852423
CD_p: 163.041962, CD_t: 9.588827, EMD: 483.693268 F1: 0.921755
CD_p: 142.317520, CD_t: 6.506372, EMD: 414.270447 F1: 0.940274
Overview results:
CD_p: 0.016204, CD_t: 0.000882, EMD: 0.049428 F1: 0.909741
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ srun -u --partition=Sensetime -n1 --gres=gpu:4 --nta
sks-per-node=1 -x G-IDC1-10-51-0-34  \
>         --job-name=knn6mb  \
>         python train.py
srun: error: Unable to allocate resources: Invalid node name specified
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --class_choice Chair
-bash: --class_choice: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --epochs 2000
-bash: --epochs: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --batch_size 64
-bash: --batch_size: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --FPD_path ./evaluation/pre_statistics_chair
.npz
-bash: --FPD_path: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --ckpt_path ./model/knn6mb/
-bash: --ckpt_path: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --n_samples_train 1000
-bash: --n_samples_train: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --eval_every_n_epoch 10
-bash: --eval_every_n_epoch: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --knn_loss True
-bash: --knn_loss: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --knn_n_seeds 100
-bash: --knn_n_seeds: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --knn_k 30
-bash: --knn_k: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --knn_scalar 0.2
-bash: --knn_scalar: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ srun -u --partition=Sensetime -n1 --gres=gpu:4 --nta
sks-per-node=1 -x G-IDC1-10-51-0-34  \
>         --job-name=knn6mb  \
>         python train.py  \
>         --class_choice Chair \
>         --epochs 2000  \
>         --batch_size 64 \
srun: error: Unable to allocate resources: Invalid node name specified
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --FPD_path ./evaluation/pre_statistics_chair
.npz  \
-bash: --FPD_path: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --ckpt_path ./model/knn6mb/ \
>         --n_samples_train 1000     \
-bash: --ckpt_path: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --eval_every_n_epoch 10    \
-bash: --eval_every_n_epoch: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --knn_loss True         \
>         --knn_n_seeds 100       \
-bash: --knn_loss: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$         --knn_k 30         \
>         --knn_scalar 0.2
-bash: --knn_k: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_benchmark]$ cd ..
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:4 --ntasks-pe
r-node=1 -x G-IDC1-10-51-0-34  \
>         --job-name=knn6mb  \
>         python train.py  \
>         --class_choice Chair \
>         --epochs 2000  \
>         --batch_size 64 \
srun: error: Unable to allocate resources: Invalid node name specified
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$         --FPD_path ./evaluation/pre_statistics_chair.npz
\
-bash: --FPD_path: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$         --ckpt_path ./model/knn6mb/ \
>         --n_samples_train 1000     \
-bash: --ckpt_path: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$         --eval_every_n_epoch 10    \
-bash: --eval_every_n_epoch: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$         --knn_loss True         \
>         --knn_n_seeds 100       \
-bash: --knn_loss: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$         --knn_k 30         \
>         --knn_scalar 0.2
-bash: --knn_k: 未找到命令
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:1 --ntasks-pe
r-node=1 -x SG-IDC1-10-51-0-34 \
>         --job-name=knn6mb \
>         python train.py \
>         --class_choice Chair --epochs 2000   --batch_size 64  \
>         --FPD_path ./evaluation/pre_statistics_chair.npz \
>         --ckpt_path ./model/knn6mb/ \
>         --n_samples_train 1000 \
>         --eval_every_n_epoch 10 \
>         --knn_loss True \
>         --knn_n_seeds 100 \
>         --knn_k 30 \
>         --knn_scalar 0.2
no EMD module
Namespace(DEGREE=[1, 2, 2, 2, 2, 2, 64], D_FEAT=[3, 64, 128, 256, 256, 512], D_iter=5, FPD_path='./evaluati
on/pre_statistics_chair.npz', G_FEAT=[96, 256, 256, 256, 128, 128, 128, 3], batch_size=64, cgan_version=0,
ckpt_load=None, ckpt_path='./model/knn6mb/', ckpt_save='tree_ckpt_', class_choice='Chair', conditional=Fals
e, dataset='BenchmarkDataset', dataset_path='/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentati
on_benchmark_v0', degrees_opt='default', device=device(type='cuda', index=0), epochs=2000, eval_every_n_epo
ch=10, expan_alpha=1.5, expan_primitive_size=64, expan_scalar=0.1, expansion_penality=False, gpu=0, knn_k=3
0, knn_loss=True, knn_n_seeds=100, knn_scalar=0.2, krepul_h=0.01, krepul_k=10, krepul_loss=False, krepul_n_
seeds=20, krepul_scalar=1, lambdaGP=10, loop_non_linear=False, lr=0.0001, n_classes=16, n_samples_train=100
0, n_sigma=1, patch_repulsion_loss=False, point_num=2048, radius_version='0', ratio_base=500, result_path='
./model/generated2/', result_save='tree_pc_', support=10, uniform_loss='None', uniform_loss_max=False, unif
orm_loss_n_seeds=20, uniform_loss_no_scale=False, uniform_loss_offset=0, uniform_loss_radius=0.05, uniform_
loss_scalar=20, uniform_loss_warmup_mode=1, uniform_loss_warmup_till=0, visdom_color=4, visdom_port=8097)
self.cat: {'Chair': '03001627'}
{'Chair': 0}
Training Dataset : 1000 prepared.
if conditional: False
network types <class 'model.gan_network.Generator'> <class 'model.gan_network.Discriminator'>
Network prepared.
[Epoch]    0 [ D_Loss ]   0.091624 [ G_Loss ]  -0.396079 [ Time ]  26.67s
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
x shape torch.Size([100, 3, 2048])
---------------------------[   0 Epoch] Frechet Pointcloud Distance <<< 267653.54 >>>
^Csrun: interrupt (one more within 1 sec to abort)
srun: task 0: running
^Csrun: sending Ctrl-C to job 416698.0
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: *** STEP 416698.0 ON SG-IDC1-10-51-0-30 CANCELLED AT 2020-07-29T15:24:52 ***
^Csrun: forcing job termination
^Csrun: job abort in progress
^Csrun: job abort in progress
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ ^C
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ ^C
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ ^C
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:4 --ntasks-pe
r-node=1 -x SG-IDC1-10-51-0-34 \
>         --job-name=knn6mb \
>         python train.py \
>         --class_choice Chair --epochs 2000   --batch_size 64  \
>         --FPD_path ./evaluation/pre_statistics_chair.npz \
>         --ckpt_path ./model/knn6mb/ \
>         --n_samples_train 1000 \
>         --eval_every_n_epoch 10 \
>         --knn_loss True \
>         --knn_n_seeds 100 \
>         --knn_k 30 \
>         --knn_scalar 0.2
no EMD module
Namespace(DEGREE=[1, 2, 2, 2, 2, 2, 64], D_FEAT=[3, 64, 128, 256, 256, 512], D_iter=5, FPD_path='./evaluati
on/pre_statistics_chair.npz', G_FEAT=[96, 256, 256, 256, 128, 128, 128, 3], batch_size=64, cgan_version=0,
ckpt_load=None, ckpt_path='./model/knn6mb/', ckpt_save='tree_ckpt_', class_choice='Chair', conditional=Fals
e, dataset='BenchmarkDataset', dataset_path='/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentati
on_benchmark_v0', degrees_opt='default', device=device(type='cuda', index=0), epochs=2000, eval_every_n_epo
ch=10, expan_alpha=1.5, expan_primitive_size=64, expan_scalar=0.1, expansion_penality=False, gpu=0, knn_k=3
0, knn_loss=True, knn_n_seeds=100, knn_scalar=0.2, krepul_h=0.01, krepul_k=10, krepul_loss=False, krepul_n_
seeds=20, krepul_scalar=1, lambdaGP=10, loop_non_linear=False, lr=0.0001, n_classes=16, n_samples_train=100
0, n_sigma=1, patch_repulsion_loss=False, point_num=2048, radius_version='0', ratio_base=500, result_path='
./model/generated2/', result_save='tree_pc_', support=10, uniform_loss='None', uniform_loss_max=False, unif
orm_loss_n_seeds=20, uniform_loss_no_scale=False, uniform_loss_offset=0, uniform_loss_radius=0.05, uniform_
loss_scalar=20, uniform_loss_warmup_mode=1, uniform_loss_warmup_till=0, visdom_color=4, visdom_port=8097)
self.cat: {'Chair': '03001627'}
{'Chair': 0}
Training Dataset : 1000 prepared.
if conditional: False
network types <class 'model.gan_network.Generator'> <class 'model.gan_network.Discriminator'>
Network prepared.
[Epoch]    0 [ D_Loss ]   0.451575 [ G_Loss ]  -0.796732 [ Time ]  46.45s
---------------------------[   0 Epoch] Frechet Pointcloud Distance <<< 13254331.83 >>>
----------------var at [0.01, 0.02, 0.05] ====== 0 11 223
[Epoch]    1 [ D_Loss ]   0.765241 [ G_Loss ]  -0.839106 [ Time ]  24.58s
[Epoch]    2 [ D_Loss ]   0.629319 [ G_Loss ]  -0.528736 [ Time ]  22.41s
[Epoch]    3 [ D_Loss ]   0.630954 [ G_Loss ]  -0.655597 [ Time ]  24.15s
[Epoch]    4 [ D_Loss ]   0.615086 [ G_Loss ]  -0.688223 [ Time ]  22.81s
[Epoch]    5 [ D_Loss ]   0.618896 [ G_Loss ]  -0.667199 [ Time ]  24.23s
[Epoch]    6 [ D_Loss ]   0.651409 [ G_Loss ]  -0.561013 [ Time ]  23.45s
[Epoch]    7 [ D_Loss ]   0.564099 [ G_Loss ]  -0.627022 [ Time ]  23.03s
[Epoch]    8 [ D_Loss ]   0.512637 [ G_Loss ]  -0.711027 [ Time ]  23.35s
[Epoch]    9 [ D_Loss ]   0.525532 [ G_Loss ]  -0.710381 [ Time ]  24.01s
[Epoch]   10 [ D_Loss ]   0.637957 [ G_Loss ]  -0.596889 [ Time ]  23.28s
---------------------------[  10 Epoch] Frechet Pointcloud Distance <<< 46657862133.85 >>>
----------------var at [0.01, 0.02, 0.05] ====== 2 7 140
[Epoch]   11 [ D_Loss ]   0.539451 [ G_Loss ]  -0.704835 [ Time ]  23.00s
[Epoch]   12 [ D_Loss ]   0.490561 [ G_Loss ]  -0.723470 [ Time ]  24.21s
[Epoch]   13 [ D_Loss ]   0.616399 [ G_Loss ]  -0.676556 [ Time ]  22.99s
[Epoch]   14 [ D_Loss ]   0.570428 [ G_Loss ]  -0.711402 [ Time ]  23.07s
[Epoch]   15 [ D_Loss ]   0.597573 [ G_Loss ]  -0.620858 [ Time ]  22.66s
[Epoch]   16 [ D_Loss ]   0.554496 [ G_Loss ]  -0.663909 [ Time ]  21.65s
[Epoch]   17 [ D_Loss ]   0.595583 [ G_Loss ]  -0.710456 [ Time ]  22.48s
[Epoch]   18 [ D_Loss ]   0.562695 [ G_Loss ]  -0.645865 [ Time ]  23.48s
[Epoch]   19 [ D_Loss ]   0.559994 [ G_Loss ]  -0.635722 [ Time ]  22.70s
[Epoch]   20 [ D_Loss ]   0.592808 [ G_Loss ]  -0.589399 [ Time ]  23.46s
---------------------------[  20 Epoch] Frechet Pointcloud Distance <<< 1204943420450.73 >>>
----------------var at [0.01, 0.02, 0.05] ====== 32 32 300
[Epoch]   21 [ D_Loss ]   0.534425 [ G_Loss ]  -0.673707 [ Time ]  23.75s
[Epoch]   22 [ D_Loss ]   0.536803 [ G_Loss ]  -0.679646 [ Time ]  23.40s
[Epoch]   23 [ D_Loss ]   0.513777 [ G_Loss ]  -0.681204 [ Time ]  21.95s
[Epoch]   24 [ D_Loss ]   0.515633 [ G_Loss ]  -0.681278 [ Time ]  24.30s
[Epoch]   25 [ D_Loss ]   0.503380 [ G_Loss ]  -0.672005 [ Time ]  22.83s
[Epoch]   26 [ D_Loss ]   0.507694 [ G_Loss ]  -0.711502 [ Time ]  24.10s
[Epoch]   27 [ D_Loss ]   0.340594 [ G_Loss ]  -0.708581 [ Time ]  24.01s
[Epoch]   28 [ D_Loss ]   0.407543 [ G_Loss ]  -0.765135 [ Time ]  23.53s
[Epoch]   29 [ D_Loss ]  -0.029707 [ G_Loss ]  -0.160418 [ Time ]  22.98s
[Epoch]   30 [ D_Loss ]  -0.202629 [ G_Loss ]   0.001719 [ Time ]  22.74s
---------------------------[  30 Epoch] Frechet Pointcloud Distance <<< 11765576456.72 >>>
----------------var at [0.01, 0.02, 0.05] ====== 22 101 592
[Epoch]   31 [ D_Loss ]  -0.222163 [ G_Loss ]   0.001633 [ Time ]  25.15s
[Epoch]   32 [ D_Loss ]  -0.247532 [ G_Loss ]   0.001516 [ Time ]  22.50s
[Epoch]   33 [ D_Loss ]  -0.288777 [ G_Loss ]   0.001488 [ Time ]  23.81s
[Epoch]   34 [ D_Loss ]   0.273111 [ G_Loss ]  -0.654850 [ Time ]  24.16s
[Epoch]   35 [ D_Loss ]   0.482190 [ G_Loss ]  -0.824904 [ Time ]  23.62s
[Epoch]   36 [ D_Loss ]   0.519185 [ G_Loss ]  -0.853009 [ Time ]  24.29s
[Epoch]   37 [ D_Loss ]   0.221306 [ G_Loss ]  -0.508501 [ Time ]  24.21s
[Epoch]   38 [ D_Loss ]   0.492858 [ G_Loss ]  -0.872423 [ Time ]  24.06s
[Epoch]   39 [ D_Loss ]   0.507978 [ G_Loss ]  -0.887104 [ Time ]  24.51s
[Epoch]   40 [ D_Loss ]   0.503875 [ G_Loss ]  -0.893218 [ Time ]  24.38s
---------------------------[  40 Epoch] Frechet Pointcloud Distance <<< 25281794.61 >>>
----------------var at [0.01, 0.02, 0.05] ====== 139 731 10009
[Epoch]   41 [ D_Loss ]   0.533040 [ G_Loss ]  -0.839506 [ Time ]  23.36s
[Epoch]   42 [ D_Loss ]   0.526384 [ G_Loss ]  -0.859426 [ Time ]  22.50s
[Epoch]   43 [ D_Loss ]   0.547290 [ G_Loss ]  -0.862681 [ Time ]  22.20s
[Epoch]   44 [ D_Loss ]   0.561648 [ G_Loss ]  -0.868914 [ Time ]  23.45s
[Epoch]   45 [ D_Loss ]   0.535124 [ G_Loss ]  -0.851772 [ Time ]  22.66s
[Epoch]   46 [ D_Loss ]   0.464504 [ G_Loss ]  -0.803562 [ Time ]  22.82s
[Epoch]   47 [ D_Loss ]   0.542290 [ G_Loss ]  -0.772027 [ Time ]  22.37s
[Epoch]   48 [ D_Loss ]   0.605534 [ G_Loss ]  -0.864192 [ Time ]  23.31s
[Epoch]   49 [ D_Loss ]   0.628274 [ G_Loss ]  -0.862169 [ Time ]  22.71s
[Epoch]   50 [ D_Loss ]   0.615193 [ G_Loss ]  -0.866330 [ Time ]  24.41s
---------------------------[  50 Epoch] Frechet Pointcloud Distance <<< 36299983.06 >>>

----------------var at [0.01, 0.02, 0.05] ====== 187 1068 15042
[Epoch]   51 [ D_Loss ]   0.601117 [ G_Loss ]  -0.852584 [ Time ]  22.78s
[Epoch]   52 [ D_Loss ]   0.549297 [ G_Loss ]  -0.846747 [ Time ]  24.84s
[Epoch]   53 [ D_Loss ]   0.554422 [ G_Loss ]  -0.845384 [ Time ]  23.44s
[Epoch]   54 [ D_Loss ]   0.477642 [ G_Loss ]  -0.808512 [ Time ]  22.63s
[Epoch]   55 [ D_Loss ]   0.398852 [ G_Loss ]  -0.748276 [ Time ]  23.46s
[Epoch]   56 [ D_Loss ]   0.390169 [ G_Loss ]  -0.617140 [ Time ]  24.45s
[Epoch]   57 [ D_Loss ]   0.622942 [ G_Loss ]  -0.854371 [ Time ]  22.90s
[Epoch]   58 [ D_Loss ]   0.606326 [ G_Loss ]  -0.865260 [ Time ]  22.82s
[Epoch]   59 [ D_Loss ]   0.558354 [ G_Loss ]  -0.850643 [ Time ]  23.58s
[Epoch]   60 [ D_Loss ]   0.474249 [ G_Loss ]  -0.814282 [ Time ]  22.71s
---------------------------[  60 Epoch] Frechet Pointcloud Distance <<< 625046992.25 >>>
----------------var at [0.01, 0.02, 0.05] ====== 137 610 10896
[Epoch]   61 [ D_Loss ]   0.452674 [ G_Loss ]  -0.827043 [ Time ]  23.77s
[Epoch]   62 [ D_Loss ]   0.440819 [ G_Loss ]  -0.818206 [ Time ]  22.29s
[Epoch]   63 [ D_Loss ]   0.363094 [ G_Loss ]  -0.691613 [ Time ]  23.47s
[Epoch]   64 [ D_Loss ]   0.501508 [ G_Loss ]  -0.785373 [ Time ]  23.13s
[Epoch]   65 [ D_Loss ]   0.534477 [ G_Loss ]  -0.823115 [ Time ]  23.70s
[Epoch]   66 [ D_Loss ]   0.556829 [ G_Loss ]  -0.828407 [ Time ]  22.63s
^Csrun: interrupt (one more within 1 sec to abort)
srun: task 0: running
^Csrun: sending Ctrl-C to job 416699.0
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: *** STEP 416699.0 ON SG-IDC1-10-51-0-30 CANCELLED AT 2020-07-29T17:14:22 ***
^Csrun: forcing job termination
^Csrun: job abort in progress
^C^Csrun: interrupt (abort already in progress)
srun: task 0: running
^Csrun: job abort in progress
^C^C^C(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ python -m torch.utils.bottleneck -h
usage: __main__.py [-h] scriptfile ...

`bottleneck` is a tool that can be used as an initial step for debugging
bottlenecks in your program. It summarizes runs of your script with the Python
profiler and PyTorch's autograd profiler. Because your script will be
profiled, please ensure that it exits in a finite amount of time. For more
complicated uses of the profilers, please see
https://docs.python.org/3/library/profile.html and
https://pytorch.org/docs/master/autograd.html#profiler for more information.

positional arguments:
  scriptfile  Path to the script to be run. Usually run with `python
              path/to/script`.
  args        Command-line arguments to be passed to the script.

optional arguments:
  -h, --help  show this help message and exit
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:4 --ntasks-pe
r-node=1 -x SG-IDC1-10-51-0-34 \
>         --job-name=knn6me \
>         python -m torch.utils.bottleneck train_single.py \
>         --class_choice Chair --epochs 1   --batch_size 64  \
>         --FPD_path ./evaluation/pre_statistics_chair.npz \
>         --ckpt_path ./model/knn6me/ \
>         --n_samples_train 1000 \
>         --eval_every_n_epoch 5 \
>         --knn_loss True \
>         --knn_n_seeds 100 \
>         --knn_k 30 \
>         --knn_scalar 0.2
`bottleneck` is a tool that can be used as an initial step for debugging
bottlenecks in your program.

It summarizes runs of your script with the Python profiler and PyTorch's
autograd profiler. Because your script will be profiled, please ensure that it
exits in a finite amount of time.

For more complicated uses of the profilers, please see
https://docs.python.org/3/library/profile.html and
https://pytorch.org/docs/master/autograd.html#profiler for more information.
Running environment analysis...
Running your script with cProfile
no EMD module
Namespace(DEGREE=[1, 2, 2, 2, 2, 2, 64], D_FEAT=[3, 64, 128, 256, 256, 512], D_iter=5, FPD_path='./evaluati
on/pre_statistics_chair.npz', G_FEAT=[96, 256, 256, 256, 128, 128, 128, 3], batch_size=64, cgan_version=0,
ckpt_load=None, ckpt_path='./model/knn6me/', ckpt_save='tree_ckpt_', class_choice='Chair', conditional=Fals
e, dataset='BenchmarkDataset', dataset_path='/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentati
on_benchmark_v0', degrees_opt='default', device=device(type='cuda', index=0), epochs=1, eval_every_n_epoch=
5, expan_alpha=1.5, expan_primitive_size=64, expan_scalar=0.1, expansion_penality=False, gpu=0, knn_k=30, k
nn_loss=True, knn_n_seeds=100, knn_scalar=0.2, krepul_h=0.01, krepul_k=10, krepul_loss=False, krepul_n_seed
s=20, krepul_scalar=1, lambdaGP=10, loop_non_linear=False, lr=0.0001, n_classes=16, n_samples_train=1000, n
_sigma=1, patch_repulsion_loss=False, point_num=2048, radius_version='0', ratio_base=500, result_path='./mo
del/generated2/', result_save='tree_pc_', support=10, uniform_loss='None', uniform_loss_max=False, uniform_
loss_n_seeds=20, uniform_loss_no_scale=False, uniform_loss_offset=0, uniform_loss_radius=0.05, uniform_loss
_scalar=20, uniform_loss_warmup_mode=1, uniform_loss_warmup_till=0, visdom_color=4, visdom_port=8097)
self.cat: {'Chair': '03001627'}
{'Chair': 0}
Training Dataset : 1000 prepared.
Network prepared.
[Epoch]    0 [ D_Loss ]  -0.029884 [ G_Loss ]  -0.593391 [ Time ]  40.16s
Running your script with the autograd profiler...
Namespace(DEGREE=[1, 2, 2, 2, 2, 2, 64], D_FEAT=[3, 64, 128, 256, 256, 512], D_iter=5, FPD_path='./evaluati
on/pre_statistics_chair.npz', G_FEAT=[96, 256, 256, 256, 128, 128, 128, 3], batch_size=64, cgan_version=0,
ckpt_load=None, ckpt_path='./model/knn6me/', ckpt_save='tree_ckpt_', class_choice='Chair', conditional=Fals
e, dataset='BenchmarkDataset', dataset_path='/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentati
on_benchmark_v0', degrees_opt='default', device=device(type='cuda', index=0), epochs=1, eval_every_n_epoch=
5, expan_alpha=1.5, expan_primitive_size=64, expan_scalar=0.1, expansion_penality=False, gpu=0, knn_k=30, k
nn_loss=True, knn_n_seeds=100, knn_scalar=0.2, krepul_h=0.01, krepul_k=10, krepul_loss=False, krepul_n_seed
s=20, krepul_scalar=1, lambdaGP=10, loop_non_linear=False, lr=0.0001, n_classes=16, n_samples_train=1000, n
_sigma=1, patch_repulsion_loss=False, point_num=2048, radius_version='0', ratio_base=500, result_path='./mo
del/generated2/', result_save='tree_pc_', support=10, uniform_loss='None', uniform_loss_max=False, uniform_
loss_n_seeds=20, uniform_loss_no_scale=False, uniform_loss_offset=0, uniform_loss_radius=0.05, uniform_loss
_scalar=20, uniform_loss_warmup_mode=1, uniform_loss_warmup_till=0, visdom_color=4, visdom_port=8097)
self.cat: {'Chair': '03001627'}
{'Chair': 0}
Training Dataset : 1000 prepared.
Network prepared.
[Epoch]    0 [ D_Loss ]   0.116367 [ G_Loss ]  -0.433826 [ Time ]  19.08s
Namespace(DEGREE=[1, 2, 2, 2, 2, 2, 64], D_FEAT=[3, 64, 128, 256, 256, 512], D_iter=5, FPD_path='./evaluati
on/pre_statistics_chair.npz', G_FEAT=[96, 256, 256, 256, 128, 128, 128, 3], batch_size=64, cgan_version=0,
ckpt_load=None, ckpt_path='./model/knn6me/', ckpt_save='tree_ckpt_', class_choice='Chair', conditional=Fals
e, dataset='BenchmarkDataset', dataset_path='/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentati
on_benchmark_v0', degrees_opt='default', device=device(type='cuda', index=0), epochs=1, eval_every_n_epoch=
5, expan_alpha=1.5, expan_primitive_size=64, expan_scalar=0.1, expansion_penality=False, gpu=0, knn_k=30, k
nn_loss=True, knn_n_seeds=100, knn_scalar=0.2, krepul_h=0.01, krepul_k=10, krepul_loss=False, krepul_n_seed
s=20, krepul_scalar=1, lambdaGP=10, loop_non_linear=False, lr=0.0001, n_classes=16, n_samples_train=1000, n
_sigma=1, patch_repulsion_loss=False, point_num=2048, radius_version='0', ratio_base=500, result_path='./mo
del/generated2/', result_save='tree_pc_', support=10, uniform_loss='None', uniform_loss_max=False, uniform_
loss_n_seeds=20, uniform_loss_no_scale=False, uniform_loss_offset=0, uniform_loss_radius=0.05, uniform_loss
_scalar=20, uniform_loss_warmup_mode=1, uniform_loss_warmup_till=0, visdom_color=4, visdom_port=8097)
self.cat: {'Chair': '03001627'}
{'Chair': 0}
Training Dataset : 1000 prepared.
Network prepared.
terminate called after throwing an instance of 'std::runtime_error'
  what():  /pytorch/torch/csrc/autograd/profiler_cuda.cpp:22: initialization error
Traceback (most recent call last):
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/data/dataloader.
py", line 724, in _try_get_data
    data = self.data_queue.get(timeout=timeout)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/threading.py", line 300, in wait
    gotit = waiter.acquire(True, timeout)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/data/_utils/sign
al_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 2534418) is killed by signal: Aborted.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/runpy.py", line 193, in _run_module_as_mai
n
    "__main__", mod_spec)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 231, in <module>
    main()
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 210, in main
    autograd_prof_cpu, autograd_prof_cuda = run_autograd_prof(code, globs)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 104, in run_autograd_prof
    result.append(run_prof(use_cuda=True))
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 98, in run_prof
    exec(code, globs, None)
  File "train_single.py", line 471, in <module>
    model.run(save_ckpt=SAVE_CHECKPOINT, load_ckpt=LOAD_CHECKPOINT, result_path=RESULT_PATH)
  File "train_single.py", line 152, in run
    for _iter, data in enumerate(self.dataLoader):
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/data/dataloader.
py", line 804, in __next__
    idx, data = self._get_data()
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/data/dataloader.
py", line 761, in _get_data
    success, data = self._try_get_data()
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/data/dataloader.
py", line 737, in _try_get_data
    raise RuntimeError('DataLoader worker (pid(s) {}) exited unexpectedly'.format(pids_str))
RuntimeError: DataLoader worker (pid(s) 2534418) exited unexpectedly
srun: error: SG-IDC1-10-51-0-42: task 0: Exited with exit code 1
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:4 --ntasks-pe
r-node=1 -x SG-IDC1-10-51-0-34         --job-name=knn6me         python -m torch.utils.bottleneck train_sin
gle.py         --class_choice Chair --epochs 1   --batch_size 64          --FPD_path ./evaluation/pre_stati
stics_chair.npz         --ckpt_path ./model/knn6me/         --n_samples_train 1000         --eval_every_n_e
poch 5         --knn_loss True         --knn_n_seeds 100         --knn_k 30         --knn_scalar 0.2
`bottleneck` is a tool that can be used as an initial step for debugging
bottlenecks in your program.

It summarizes runs of your script with the Python profiler and PyTorch's
autograd profiler. Because your script will be profiled, please ensure that it
exits in a finite amount of time.

For more complicated uses of the profilers, please see
https://docs.python.org/3/library/profile.html and
https://pytorch.org/docs/master/autograd.html#profiler for more information.
Running environment analysis...
Running your script with cProfile
no EMD module
Namespace(DEGREE=[1, 2, 2, 2, 2, 2, 64], D_FEAT=[3, 64, 128, 256, 256, 512], D_iter=5, FPD_path='./evaluati
on/pre_statistics_chair.npz', G_FEAT=[96, 256, 256, 256, 128, 128, 128, 3], batch_size=64, cgan_version=0,
ckpt_load=None, ckpt_path='./model/knn6me/', ckpt_save='tree_ckpt_', class_choice='Chair', conditional=Fals
e, dataset='BenchmarkDataset', dataset_path='/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentati
on_benchmark_v0', degrees_opt='default', device=device(type='cuda', index=0), epochs=1, eval_every_n_epoch=
5, expan_alpha=1.5, expan_primitive_size=64, expan_scalar=0.1, expansion_penality=False, gpu=0, knn_k=30, k
nn_loss=True, knn_n_seeds=100, knn_scalar=0.2, krepul_h=0.01, krepul_k=10, krepul_loss=False, krepul_n_seed
s=20, krepul_scalar=1, lambdaGP=10, loop_non_linear=False, lr=0.0001, n_classes=16, n_samples_train=1000, n
_sigma=1, patch_repulsion_loss=False, point_num=2048, radius_version='0', ratio_base=500, result_path='./mo
del/generated2/', result_save='tree_pc_', support=10, uniform_loss='None', uniform_loss_max=False, uniform_
loss_n_seeds=20, uniform_loss_no_scale=False, uniform_loss_offset=0, uniform_loss_radius=0.05, uniform_loss
_scalar=20, uniform_loss_warmup_mode=1, uniform_loss_warmup_till=0, visdom_color=4, visdom_port=8097)
self.cat: {'Chair': '03001627'}
{'Chair': 0}
Training Dataset : 1000 prepared.
Network prepared.
[Epoch]    0 [ D_Loss ]   0.076527 [ G_Loss ]  -0.585882 [ Time ]  40.34s
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/numpy/core/fromnumeric.py:3373: Runt
imeWarning: Mean of empty slice.
  out=out, **kwargs)
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/numpy/core/_methods.py:163: RuntimeW
arning: invalid value encountered in true_divide
  ret, rcount, out=ret, casting='unsafe', subok=False)
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/numpy/lib/function_base.py:380: Runt
imeWarning: Mean of empty slice.
  avg = a.mean(axis)
/mnt/lustre/zhangjunzhe/pcd_lib/evaluation/FPD.py:156: RuntimeWarning: Degrees of freedom <= 0 for slice
  sigma = np.cov(act, rowvar=False)
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/numpy/lib/function_base.py:2480: Run
timeWarning: divide by zero encountered in true_divide
  c *= np.true_divide(1, fact)
/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/numpy/lib/function_base.py:2480: Run
timeWarning: invalid value encountered in multiply
  c *= np.true_divide(1, fact)
Traceback (most recent call last):
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/runpy.py", line 193, in _run_module_as_mai
n
    "__main__", mod_spec)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 231, in <module>
    main()
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 209, in main
    cprofile_prof = run_cprofile(code, globs)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 74, in run_cprofile
    exec(code, globs, None)
  File "train_single.py", line 472, in <module>
    model.run(save_ckpt=SAVE_CHECKPOINT, load_ckpt=LOAD_CHECKPOINT, result_path=RESULT_PATH)
  File "train_single.py", line 409, in run
    fpd = calculate_fpd(fake_pointclouds, statistic_save_path=self.args.FPD_path, batch_size=100, dims=1808
, device=self.args.device)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/evaluation/FPD.py", line 200, in calculate_fpd
    fid_value = calculate_frechet_distance(m1, s1, m2, s2)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/evaluation/FPD.py", line 114, in calculate_frechet_distance
    covmean, _ = sqrtm(sigma1.dot(sigma2), disp=False)
  File "/mnt/lustre/zhangjunzhe/.local/lib/python3.7/site-packages/scipy/linalg/_matfuncs_sqrtm.py", line 1
63, in sqrtm
    A = _asarray_validated(A, check_finite=True, as_inexact=True)
  File "/mnt/lustre/zhangjunzhe/.local/lib/python3.7/site-packages/scipy/_lib/_util.py", line 238, in _asar
ray_validated
    a = toarray(a)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/numpy/lib/function_base.py",
 line 486, in asarray_chkfinite
    "array must not contain infs or NaNs")
ValueError: array must not contain infs or NaNs
srun: error: SG-IDC1-10-51-0-33: task 0: Exited with exit code 1
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:1 --ntasks-pe
r-node=1 \
>         --job-name=trial \
>         python gi_train.py \
>         --batch_size 10 \
>         --n_samples_train 1000 \
>         --ftr_type Discriminator \
>         --update_G True \
>         --save_inversion_path ./saved_samples/invert_topnet_scan2 \
>         --ckpt_load ./model/knn6m/tree_ckpt_1870_Chair.pt \
>         --dgp_mode topnet \
>         --n_bins 8 \
>         --max_bins 16 \
>         --target_resol_bins 16 \
>         --init_by_ftr_loss False \
>         --increase_n_bins True \
>         --downsample True \
>         --cd_option one_sided
srun: job 416756 queued and waiting for resources
srun: job 416756 has been allocated resources
no EMD module
Traceback (most recent call last):
  File "gi_train.py", line 29, in <module>
    from plots.completion_pcd_plot import draw_any_set
  File "/mnt/lustre/zhangjunzhe/pcd_lib/plots/completion_pcd_plot.py", line 6, in <module>
    from mpl_toolkits.mplot3d import Axes3D
ModuleNotFoundError: No module named 'mpl_toolkits'
srun: error: SG-IDC1-10-51-0-33: task 0: Exited with exit code 1
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ pip install matplotlib
Collecting matplotlib
  Using cached matplotlib-3.3.0-1-cp37-cp37m-manylinux1_x86_64.whl (11.5 MB)
Requirement already satisfied: pillow>=6.2.0 in /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/si
te-packages (from matplotlib) (7.2.0)
Collecting kiwisolver>=1.0.1
  Using cached kiwisolver-1.2.0-cp37-cp37m-manylinux1_x86_64.whl (88 kB)
Requirement already satisfied: numpy>=1.15 in /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site
-packages (from matplotlib) (1.19.1)
Collecting cycler>=0.10
  Using cached cycler-0.10.0-py2.py3-none-any.whl (6.5 kB)
Collecting python-dateutil>=2.1
  Using cached python_dateutil-2.8.1-py2.py3-none-any.whl (227 kB)
Collecting pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.3
  Using cached pyparsing-2.4.7-py2.py3-none-any.whl (67 kB)
Requirement already satisfied: six in /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-package
s (from cycler>=0.10->matplotlib) (1.15.0)
Installing collected packages: kiwisolver, cycler, python-dateutil, pyparsing, matplotlib
Successfully installed cycler-0.10.0 kiwisolver-1.2.0 matplotlib-3.3.0 pyparsing-2.4.7 python-dateutil-2.8.
1
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:1 --ntasks-pe
r-node=1         --job-name=trial         python gi_train.py         --batch_size 10         --n_samples_tr
ain 1000         --ftr_type Discriminator         --update_G True         --save_inversion_path ./saved_sam
ples/invert_topnet_scan2         --ckpt_load ./model/knn6m/tree_ckpt_1870_Chair.pt         --dgp_mode topne
t         --n_bins 8         --max_bins 16         --target_resol_bins 16         --init_by_ftr_loss False
        --increase_n_bins True         --downsample True         --cd_option one_sided
no EMD module
called here, treegan_utils
{'dataset_path': '/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0', 'class_ch
oice': 'Chair', 'batch_size': 10, 'point_num': 2048, 'gpu': 0, 'epochs': 2, 'lr': 0.0001, 'ckpt_path': './m
odel/checkpoints2/', 'ckpt_save': 'tree_ckpt_', 'ckpt_load': './model/knn6m/tree_ckpt_1870_Chair.pt', 'resu
lt_path': './model/generated2/', 'result_save': 'tree_pc_', 'visdom_port': 8097, 'visdom_color': 4, 'lambda
GP': 10, 'D_iter': 5, 'support': 10, 'degrees_opt': 'default', 'G_FEAT': [96, 256, 256, 256, 128, 128, 128,
 3], 'D_FEAT': [3, 64, 128, 256, 256, 512], 'FPD_path': './evaluation/pre_statistics_chair.npz', 'ratio_bas
e': 500, 'dataset': 'BenchmarkDataset', 'uniform_loss': 'None', 'uniform_loss_scalar': 20, 'uniform_loss_ra
dius': 0.05, 'uniform_loss_warmup_till': 0, 'uniform_loss_warmup_mode': 1, 'radius_version': '0', 'uniform_
loss_n_seeds': 20, 'uniform_loss_no_scale': False, 'uniform_loss_max': False, 'uniform_loss_offset': 0, 'lo
op_non_linear': False, 'n_samples_train': 1000, 'eval_every_n_epoch': 5, 'patch_repulsion_loss': False, 'n_
sigma': 1, 'knn_loss': False, 'knn_k': 10, 'knn_n_seeds': 20, 'knn_scalar': 1, 'krepul_loss': False, 'krepu
l_k': 10, 'krepul_n_seeds': 20, 'krepul_scalar': 1, 'krepul_h': 0.01, 'expansion_penality': False, 'expan_p
rimitive_size': 64, 'expan_alpha': 1.5, 'expan_scalar': 0.1, 'dist': False, 'port': '12345', 'exp_path': ''
, 'root_dir': '', 'list_file': '', 'resolution': 256, 'random_G': False, 'update_G': True, 'update_embed':
False, 'save_G': False, 'ftr_type': 'Discriminator', 'ftr_num': [3], 'ft_num': [2], 'print_interval': 100,
'save_interval': None, 'lr_ratio': [1.0, 1.0, 1.0, 1.0], 'w_D_loss': [0.1], 'w_nll': 0.001, 'w_mse': [0.1],
 'select_num': 500, 'sample_std': 1.0, 'iterations': [200, 200, 200, 200], 'G_lrs': [1e-06, 2e-05, 1e-05, 1
e-06], 'z_lrs': [0.1, 0.001, 1e-05, 1e-06], 'warm_up': 0, 'use_in': [False, False, False, False], 'stop_mse
': 0.0, 'stop_ftr': 0.0, 'save_inversion_path': './saved_samples/invert_topnet_scan2', 'use_emd_loss': Fals
e, 'dgp_mode': 'topnet', 'hole_radius': 0.5, 'hole_k': 500, 'hole_n': 1, 'n_bins': 8, 'max_bins': 16, 'targ
et_resol_bins': 16, 'cd_option': 'one_sided', 'init_by_ftr_loss': False, 'increase_n_bins': True, 'given_pa
rtial': True, 'downsample': False}
self.cat: {'Chair': '03001627'}
{'Chair': 0}
1000
self.cat: {'Chair': '03001627'}
{'Chair': 0}
3746
2746
len and sample of pcs 100 /mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0/030
01627/points/fee36ec8c8ae503fc68456e8da5b9a30.pts
self.z at init True
init DGP done
use_emd_loss False
size of intersect basenames 81
b455c3037b013d85492d9da2668ec34c.h5
pcs_list[0] type <class 'dict'>
init_by_ftr_loss False
target_resol_bins 16
n and 1's sum 16 tensor(1040., device='cuda:0')
print init x_map and target cd 0.007287443149834871
self.n_bins 8
stage 0 -- 0.0026783421635627747
self.n_bins 16
stage 1 -- 0.0014432736206799746
self.n_bins 16
stage 2 -- 0.0013024064246565104
self.n_bins 16
stage 3 -- 0.00121218990534544
Traceback (most recent call last):
  File "gi_train.py", line 319, in <module>
    dgp.run()
  File "/mnt/lustre/zhangjunzhe/pcd_lib/dgp.py", line 287, in run
    test_emd = self.emd(x, self.target_origin)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/loss.py", line 549, in __call__
    cost = self.emd(fake_img, real_img)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/nn/modules/module.py",
 line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/loss.py", line 463, in forward
    return EarthMoverDistanceFunction.apply(input1, input2)
  File "/mnt/lustre/zhangjunzhe/pcd_lib/loss.py", line 446, in forward
    match = emd_cuda.approxmatch_forward(xyz1, xyz2)
NameError: name 'emd_cuda' is not defined
srun: error: SG-IDC1-10-51-0-30: task 0: Exited with exit code 1
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:1 --ntasks-pe
r-node=1         --job-name=trial         python gi_train.py         --batch_size 10         --n_samples_tr
ain 1000         --ftr_type Discriminator         --update_G True         --save_inversion_path ./saved_sam
ples/invert_topnet_scan2         --ckpt_load ./model/knn6m/tree_ckpt_1870_Chair.pt         --dgp_mode topne
t         --n_bins 8         --max_bins 16         --target_resol_bins 16         --init_by_ftr_loss False
        --increase_n_bins True         --downsample True         --cd_option one_sided
no EMD module
called here, treegan_utils
{'dataset_path': '/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0', 'class_ch
oice': 'Chair', 'batch_size': 10, 'point_num': 2048, 'gpu': 0, 'epochs': 2, 'lr': 0.0001, 'ckpt_path': './m
odel/checkpoints2/', 'ckpt_save': 'tree_ckpt_', 'ckpt_load': './model/knn6m/tree_ckpt_1870_Chair.pt', 'resu
lt_path': './model/generated2/', 'result_save': 'tree_pc_', 'visdom_port': 8097, 'visdom_color': 4, 'lambda
GP': 10, 'D_iter': 5, 'support': 10, 'degrees_opt': 'default', 'G_FEAT': [96, 256, 256, 256, 128, 128, 128,
 3], 'D_FEAT': [3, 64, 128, 256, 256, 512], 'FPD_path': './evaluation/pre_statistics_chair.npz', 'ratio_bas
e': 500, 'dataset': 'BenchmarkDataset', 'uniform_loss': 'None', 'uniform_loss_scalar': 20, 'uniform_loss_ra
dius': 0.05, 'uniform_loss_warmup_till': 0, 'uniform_loss_warmup_mode': 1, 'radius_version': '0', 'uniform_
loss_n_seeds': 20, 'uniform_loss_no_scale': False, 'uniform_loss_max': False, 'uniform_loss_offset': 0, 'lo
op_non_linear': False, 'n_samples_train': 1000, 'eval_every_n_epoch': 5, 'patch_repulsion_loss': False, 'n_
sigma': 1, 'knn_loss': False, 'knn_k': 10, 'knn_n_seeds': 20, 'knn_scalar': 1, 'krepul_loss': False, 'krepu
l_k': 10, 'krepul_n_seeds': 20, 'krepul_scalar': 1, 'krepul_h': 0.01, 'expansion_penality': False, 'expan_p
rimitive_size': 64, 'expan_alpha': 1.5, 'expan_scalar': 0.1, 'dist': False, 'port': '12345', 'exp_path': ''
, 'root_dir': '', 'list_file': '', 'resolution': 256, 'random_G': False, 'update_G': True, 'update_embed':
False, 'save_G': False, 'ftr_type': 'Discriminator', 'ftr_num': [3], 'ft_num': [2], 'print_interval': 100,
'save_interval': None, 'lr_ratio': [1.0, 1.0, 1.0, 1.0], 'w_D_loss': [0.1], 'w_nll': 0.001, 'w_mse': [0.1],
 'select_num': 500, 'sample_std': 1.0, 'iterations': [200, 200, 200, 200], 'G_lrs': [1e-06, 2e-05, 1e-05, 1
e-06], 'z_lrs': [0.1, 0.001, 1e-05, 1e-06], 'warm_up': 0, 'use_in': [False, False, False, False], 'stop_mse
': 0.0, 'stop_ftr': 0.0, 'save_inversion_path': './saved_samples/invert_topnet_scan2', 'use_emd_loss': Fals
e, 'dgp_mode': 'topnet', 'hole_radius': 0.5, 'hole_k': 500, 'hole_n': 1, 'n_bins': 8, 'max_bins': 16, 'targ
et_resol_bins': 16, 'cd_option': 'one_sided', 'init_by_ftr_loss': False, 'increase_n_bins': True, 'given_pa
rtial': True, 'downsample': False}
self.cat: {'Chair': '03001627'}
{'Chair': 0}
1000
self.cat: {'Chair': '03001627'}
{'Chair': 0}
3746
2746
len and sample of pcs 100 /mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0/030
01627/points/fee36ec8c8ae503fc68456e8da5b9a30.pts
self.z at init True
init DGP done
use_emd_loss False
size of intersect basenames 81
b455c3037b013d85492d9da2668ec34c.h5
pcs_list[0] type <class 'dict'>
init_by_ftr_loss False
target_resol_bins 16
n and 1's sum 16 tensor(1040., device='cuda:0')
print init x_map and target cd 0.007981854490935802
self.n_bins 8
stage 0 -- 0.0023058217484503984
self.n_bins 16
stage 1 -- 0.001402736408635974
self.n_bins 16
stage 2 -- 0.0012954606208950281
self.n_bins 16
stage 3 -- 0.001198647078126669
save pcs done
68 done,  53 s
number of examples 1
cd mean: 0.001198647078126669   var: 0.0
emd mean: 0.001198647078126669   var: 0.0
ftr_loss mean: 0.0010975743643939495   var: 0.0
nll mean: 1.3330907821655273   var: 0.0
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:1 --ntasks-pe
r-node=1 \
>         --job-name=trial \
>         python -m torch.utils.bottleneck python gi_train.py \
>         --batch_size 10 \
>         --n_samples_train 1000 \
>         --ftr_type Discriminator \
>         --update_G True \
>         --save_inversion_path ./saved_samples/invert_topnet_scan2 \
>         --ckpt_load ./model/knn6m/tree_ckpt_1870_Chair.pt \
>         --dgp_mode topnet \
>         --n_bins 8 \
>         --max_bins 16 \
>         --target_resol_bins 16 \
>         --init_by_ftr_loss False \
>         --increase_n_bins True \
>         --downsample True \
>         --cd_option one_sided
Traceback (most recent call last):
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/runpy.py", line 193, in _run_module_as_mai
n
    "__main__", mod_spec)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 231, in <module>
    main()
  File "/mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site-packages/torch/utils/bottleneck/__mai
n__.py", line 194, in main
    with open(scriptfile, 'rb') as stream:
FileNotFoundError: [Errno 2] No such file or directory: 'python'
srun: error: SG-IDC1-10-51-0-30: task 0: Exited with exit code 1
(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$ srun -u --partition=Sensetime -n1 --gres=gpu:1 --ntasks-pe
r-node=1 \
>         --job-name=trial \
>         python -m torch.utils.bottleneck gi_train.py \
>         --batch_size 10 \
>         --n_samples_train 1000 \
>         --ftr_type Discriminator \
>         --update_G True \
>         --save_inversion_path ./saved_samples/invert_topnet_scan2 \
>         --ckpt_load ./model/knn6m/tree_ckpt_1870_Chair.pt \
>         --dgp_mode topnet \
>         --n_bins 8 \
>         --max_bins 16 \
>         --target_resol_bins 16 \
>         --init_by_ftr_loss False \
>         --increase_n_bins True \
>         --downsample True \
>         --cd_option one_sided
`bottleneck` is a tool that can be used as an initial step for debugging
bottlenecks in your program.

It summarizes runs of your script with the Python profiler and PyTorch's
autograd profiler. Because your script will be profiled, please ensure that it
exits in a finite amount of time.

For more complicated uses of the profilers, please see
https://docs.python.org/3/library/profile.html and
https://pytorch.org/docs/master/autograd.html#profiler for more information.
Running environment analysis...
Running your script with cProfile
no EMD module
called here, treegan_utils
{'dataset_path': '/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0', 'class_ch
oice': 'Chair', 'batch_size': 10, 'point_num': 2048, 'gpu': 0, 'epochs': 2, 'lr': 0.0001, 'ckpt_path': './m
odel/checkpoints2/', 'ckpt_save': 'tree_ckpt_', 'ckpt_load': './model/knn6m/tree_ckpt_1870_Chair.pt', 'resu
lt_path': './model/generated2/', 'result_save': 'tree_pc_', 'visdom_port': 8097, 'visdom_color': 4, 'lambda
GP': 10, 'D_iter': 5, 'support': 10, 'degrees_opt': 'default', 'G_FEAT': [96, 256, 256, 256, 128, 128, 128,
 3], 'D_FEAT': [3, 64, 128, 256, 256, 512], 'FPD_path': './evaluation/pre_statistics_chair.npz', 'ratio_bas
e': 500, 'dataset': 'BenchmarkDataset', 'uniform_loss': 'None', 'uniform_loss_scalar': 20, 'uniform_loss_ra
dius': 0.05, 'uniform_loss_warmup_till': 0, 'uniform_loss_warmup_mode': 1, 'radius_version': '0', 'uniform_
loss_n_seeds': 20, 'uniform_loss_no_scale': False, 'uniform_loss_max': False, 'uniform_loss_offset': 0, 'lo
op_non_linear': False, 'n_samples_train': 1000, 'eval_every_n_epoch': 5, 'patch_repulsion_loss': False, 'n_
sigma': 1, 'knn_loss': False, 'knn_k': 10, 'knn_n_seeds': 20, 'knn_scalar': 1, 'krepul_loss': False, 'krepu
l_k': 10, 'krepul_n_seeds': 20, 'krepul_scalar': 1, 'krepul_h': 0.01, 'expansion_penality': False, 'expan_p
rimitive_size': 64, 'expan_alpha': 1.5, 'expan_scalar': 0.1, 'dist': False, 'port': '12345', 'exp_path': ''
, 'root_dir': '', 'list_file': '', 'resolution': 256, 'random_G': False, 'update_G': True, 'update_embed':
False, 'save_G': False, 'ftr_type': 'Discriminator', 'ftr_num': [3], 'ft_num': [2], 'print_interval': 100,
'save_interval': None, 'lr_ratio': [1.0, 1.0, 1.0, 1.0], 'w_D_loss': [0.1], 'w_nll': 0.001, 'w_mse': [0.1],
 'select_num': 500, 'sample_std': 1.0, 'iterations': [200, 200, 200, 200], 'G_lrs': [1e-06, 2e-05, 1e-05, 1
e-06], 'z_lrs': [0.1, 0.001, 1e-05, 1e-06], 'warm_up': 0, 'use_in': [False, False, False, False], 'stop_mse
': 0.0, 'stop_ftr': 0.0, 'save_inversion_path': './saved_samples/invert_topnet_scan2', 'use_emd_loss': Fals
e, 'dgp_mode': 'topnet', 'hole_radius': 0.5, 'hole_k': 500, 'hole_n': 1, 'n_bins': 8, 'max_bins': 16, 'targ
et_resol_bins': 16, 'cd_option': 'one_sided', 'init_by_ftr_loss': False, 'increase_n_bins': True, 'given_pa
rtial': True, 'downsample': False}
self.cat: {'Chair': '03001627'}
{'Chair': 0}
1000
self.cat: {'Chair': '03001627'}
{'Chair': 0}
3746
2746
len and sample of pcs 100 /mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0/030
01627/points/fee36ec8c8ae503fc68456e8da5b9a30.pts
self.z at init True
init DGP done
use_emd_loss False
size of intersect basenames 81
b455c3037b013d85492d9da2668ec34c.h5
pcs_list[0] type <class 'dict'>
init_by_ftr_loss False
target_resol_bins 16
n and 1's sum 16 tensor(1040., device='cuda:0')
print init x_map and target cd 0.0024134893901646137
self.n_bins 8
stage 0 -- 0.0029644500464200974
self.n_bins 16
stage 1 -- 0.004065681714564562
self.n_bins 16
stage 2 -- 0.010488678701221943
self.n_bins 16
stage 3 -- 0.011628663167357445
save pcs done
68 done,  50 s
number of examples 1
cd mean: 0.011628663167357445   var: 0.0
emd mean: 0.011628663167357445   var: 0.0
ftr_loss mean: 0.002754179760813713   var: 0.0
nll mean: 1.370037317276001   var: 0.0
Running your script with the autograd profiler...
called here, treegan_utils
{'dataset_path': '/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0', 'class_ch
oice': 'Chair', 'batch_size': 10, 'point_num': 2048, 'gpu': 0, 'epochs': 2, 'lr': 0.0001, 'ckpt_path': './m
odel/checkpoints2/', 'ckpt_save': 'tree_ckpt_', 'ckpt_load': './model/knn6m/tree_ckpt_1870_Chair.pt', 'resu
lt_path': './model/generated2/', 'result_save': 'tree_pc_', 'visdom_port': 8097, 'visdom_color': 4, 'lambda
GP': 10, 'D_iter': 5, 'support': 10, 'degrees_opt': 'default', 'G_FEAT': [96, 256, 256, 256, 128, 128, 128,
 3], 'D_FEAT': [3, 64, 128, 256, 256, 512], 'FPD_path': './evaluation/pre_statistics_chair.npz', 'ratio_bas
e': 500, 'dataset': 'BenchmarkDataset', 'uniform_loss': 'None', 'uniform_loss_scalar': 20, 'uniform_loss_ra
dius': 0.05, 'uniform_loss_warmup_till': 0, 'uniform_loss_warmup_mode': 1, 'radius_version': '0', 'uniform_
loss_n_seeds': 20, 'uniform_loss_no_scale': False, 'uniform_loss_max': False, 'uniform_loss_offset': 0, 'lo
op_non_linear': False, 'n_samples_train': 1000, 'eval_every_n_epoch': 5, 'patch_repulsion_loss': False, 'n_
sigma': 1, 'knn_loss': False, 'knn_k': 10, 'knn_n_seeds': 20, 'knn_scalar': 1, 'krepul_loss': False, 'krepu
l_k': 10, 'krepul_n_seeds': 20, 'krepul_scalar': 1, 'krepul_h': 0.01, 'expansion_penality': False, 'expan_p
rimitive_size': 64, 'expan_alpha': 1.5, 'expan_scalar': 0.1, 'dist': False, 'port': '12345', 'exp_path': ''
, 'root_dir': '', 'list_file': '', 'resolution': 256, 'random_G': False, 'update_G': True, 'update_embed':
False, 'save_G': False, 'ftr_type': 'Discriminator', 'ftr_num': [3], 'ft_num': [2], 'print_interval': 100,
'save_interval': None, 'lr_ratio': [1.0, 1.0, 1.0, 1.0], 'w_D_loss': [0.1], 'w_nll': 0.001, 'w_mse': [0.1],
 'select_num': 500, 'sample_std': 1.0, 'iterations': [200, 200, 200, 200], 'G_lrs': [1e-06, 2e-05, 1e-05, 1
e-06], 'z_lrs': [0.1, 0.001, 1e-05, 1e-06], 'warm_up': 0, 'use_in': [False, False, False, False], 'stop_mse
': 0.0, 'stop_ftr': 0.0, 'save_inversion_path': './saved_samples/invert_topnet_scan2', 'use_emd_loss': Fals
e, 'dgp_mode': 'topnet', 'hole_radius': 0.5, 'hole_k': 500, 'hole_n': 1, 'n_bins': 8, 'max_bins': 16, 'targ
et_resol_bins': 16, 'cd_option': 'one_sided', 'init_by_ftr_loss': False, 'increase_n_bins': True, 'given_pa
rtial': True, 'downsample': False}
self.cat: {'Chair': '03001627'}
{'Chair': 0}
1000
self.cat: {'Chair': '03001627'}
{'Chair': 0}
3746
2746
len and sample of pcs 100 /mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0/030
01627/points/fee36ec8c8ae503fc68456e8da5b9a30.pts
self.z at init True
init DGP done
use_emd_loss False
size of intersect basenames 81
b455c3037b013d85492d9da2668ec34c.h5
pcs_list[0] type <class 'dict'>
init_by_ftr_loss False
target_resol_bins 16
n and 1's sum 16 tensor(1040., device='cuda:0')
print init x_map and target cd 0.0065218317322432995
self.n_bins 8
stage 0 -- 0.002565438160672784
self.n_bins 16
^[[5~stage 1 -- 0.00520765595138073
self.n_bins 16
stage 2 -- 0.010298957116901875
self.n_bins 16
stage 3 -- 0.010127016343176365
save pcs done
68 done,  56 s
number of examples 1
cd mean: 0.010127016343176365   var: 0.0
emd mean: 0.010127016343176365   var: 0.0
ftr_loss mean: 0.0027440688572824   var: 0.0
nll mean: 1.2459919452667236   var: 0.0
called here, treegan_utils
{'dataset_path': '/mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0', 'class_ch
oice': 'Chair', 'batch_size': 10, 'point_num': 2048, 'gpu': 0, 'epochs': 2, 'lr': 0.0001, 'ckpt_path': './m
odel/checkpoints2/', 'ckpt_save': 'tree_ckpt_', 'ckpt_load': './model/knn6m/tree_ckpt_1870_Chair.pt', 'resu
lt_path': './model/generated2/', 'result_save': 'tree_pc_', 'visdom_port': 8097, 'visdom_color': 4, 'lambda
GP': 10, 'D_iter': 5, 'support': 10, 'degrees_opt': 'default', 'G_FEAT': [96, 256, 256, 256, 128, 128, 128,
 3], 'D_FEAT': [3, 64, 128, 256, 256, 512], 'FPD_path': './evaluation/pre_statistics_chair.npz', 'ratio_bas
e': 500, 'dataset': 'BenchmarkDataset', 'uniform_loss': 'None', 'uniform_loss_scalar': 20, 'uniform_loss_ra
dius': 0.05, 'uniform_loss_warmup_till': 0, 'uniform_loss_warmup_mode': 1, 'radius_version': '0', 'uniform_
loss_n_seeds': 20, 'uniform_loss_no_scale': False, 'uniform_loss_max': False, 'uniform_loss_offset': 0, 'lo
op_non_linear': False, 'n_samples_train': 1000, 'eval_every_n_epoch': 5, 'patch_repulsion_loss': False, 'n_
sigma': 1, 'knn_loss': False, 'knn_k': 10, 'knn_n_seeds': 20, 'knn_scalar': 1, 'krepul_loss': False, 'krepu
l_k': 10, 'krepul_n_seeds': 20, 'krepul_scalar': 1, 'krepul_h': 0.01, 'expansion_penality': False, 'expan_p
rimitive_size': 64, 'expan_alpha': 1.5, 'expan_scalar': 0.1, 'dist': False, 'port': '12345', 'exp_path': ''
, 'root_dir': '', 'list_file': '', 'resolution': 256, 'random_G': False, 'update_G': True, 'update_embed':
False, 'save_G': False, 'ftr_type': 'Discriminator', 'ftr_num': [3], 'ft_num': [2], 'print_interval': 100,
'save_interval': None, 'lr_ratio': [1.0, 1.0, 1.0, 1.0], 'w_D_loss': [0.1], 'w_nll': 0.001, 'w_mse': [0.1],
 'select_num': 500, 'sample_std': 1.0, 'iterations': [200, 200, 200, 200], 'G_lrs': [1e-06, 2e-05, 1e-05, 1
e-06], 'z_lrs': [0.1, 0.001, 1e-05, 1e-06], 'warm_up': 0, 'use_in': [False, False, False, False], 'stop_mse
': 0.0, 'stop_ftr': 0.0, 'save_inversion_path': './saved_samples/invert_topnet_scan2', 'use_emd_loss': Fals
e, 'dgp_mode': 'topnet', 'hole_radius': 0.5, 'hole_k': 500, 'hole_n': 1, 'n_bins': 8, 'max_bins': 16, 'targ
et_resol_bins': 16, 'cd_option': 'one_sided', 'init_by_ftr_loss': False, 'increase_n_bins': True, 'given_pa
rtial': True, 'downsample': False}
self.cat: {'Chair': '03001627'}
{'Chair': 0}
1000
self.cat: {'Chair': '03001627'}
{'Chair': 0}
3746
2746
len and sample of pcs 100 /mnt/lustre/share/zhangjunzhe/shapenetcore_partanno_segmentation_benchmark_v0/030
01627/points/fee36ec8c8ae503fc68456e8da5b9a30.pts
self.z at init True
init DGP done
use_emd_loss False
size of intersect basenames 81
b455c3037b013d85492d9da2668ec34c.h5
pcs_list[0] type <class 'dict'>
init_by_ftr_loss False
target_resol_bins 16
n and 1's sum 16 tensor(1040., device='cuda:0')
print init x_map and target cd 0.006396003067493439
self.n_bins 8
stage 0 -- 0.0026735709980130196
self.n_bins 16
stage 1 -- 0.0012033898383378983
self.n_bins 16
stage 2 -- 0.0010532450396567583
self.n_bins 16
stage 3 -- 0.0010063651716336608
save pcs done
68 done,  170 s
number of examples 1
cd mean: 0.0010063651716336608   var: 0.0
emd mean: 0.0010063651716336608   var: 0.0
ftr_loss mean: 0.0008939493563957512   var: 0.0
nll mean: 1.2486298084259033   var: 0.0
--------------------------------------------------------------------------------
  Environment Summary
--------------------------------------------------------------------------------
PyTorch 1.2.0 compiled w/ CUDA 10.0.130
Running with Python 3.7 and CUDA 10.0.130

`pip3 list` truncated output:
numpy==1.19.1
torch==1.2.0
torchfile==0.1.0
torchvision==0.4.0
--------------------------------------------------------------------------------
  cProfile output
--------------------------------------------------------------------------------
         10804964 function calls (10013116 primitive calls) in 72.496 seconds

   Ordered by: internal time
   List reduced from 3956 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      803   12.987    0.016   14.406    0.018 /mnt/lustre/zhangjunzhe/pcd_lib/dgp.py:415(pre_process)
      800   11.740    0.015   11.740    0.015 {method 'run_backward' of 'torch._C._EngineBase' objects}
     1638   10.305    0.006   10.305    0.006 {method 'to' of 'torch._C._TensorBase' objects}
     9114    2.848    0.000   11.187    0.001 /mnt/lustre/zhangjunzhe/pcd_lib/layers/gcn.py:50(forward)
    54684    2.730    0.000    2.730    0.000 {method 'matmul' of 'torch._C._TensorBase' objects}
    53382    2.435    0.000    2.435    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
    89600    1.950    0.000    1.950    0.000 {method 'mul_' of 'torch._C._TensorBase' objects}
    89600    1.716    0.000    1.716    0.000 {method 'add_' of 'torch._C._TensorBase' objects}
     8000    1.180    0.000    1.180    0.000 {built-in method conv1d}
       96    1.053    0.011    1.094    0.011 {method 'draw_path_collection' of 'matplotlib.backends._backe
nd_agg.RendererAgg' objects}
      200    0.998    0.005    3.887    0.019 /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site
-packages/numpy/lib/npyio.py:1040(read_data)
    44800    0.940    0.000    0.940    0.000 {method 'sqrt' of 'torch._C._TensorBase' objects}
     1600    0.906    0.001    7.218    0.005 /mnt/lustre/zhangjunzhe/anaconda3/envs/msn/lib/python3.7/site
-packages/torch/optim/adam.py:49(step)
    44800    0.810    0.000    0.810    0.000 {method 'addcdiv_' of 'torch._C._TensorBase' objects}
    44800    0.805    0.000    0.805    0.000 {method 'addcmul_' of 'torch._C._TensorBase' objects}


--------------------------------------------------------------------------------
  autograd profiler output (CPU mode)
--------------------------------------------------------------------------------
        top 15 events sorted by cpu_time_total

---------------------  ---------------  ---------------  ---------------  ---------------  ---------------
 ---------------  ---------------  ---------------  ---------------  -----------------------------------
Name                   Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg
  CUDA total %     CUDA total       CUDA time avg    Number of Calls  Input Shapes
---------------------  ---------------  ---------------  ---------------  ---------------  ---------------
 ---------------  ---------------  ---------------  ---------------  -----------------------------------
uniform_               35.69%           404.201ms        35.69%           404.201ms        404.201ms
 NaN              0.000us          0.000us          1                []
matmul                 18.51%           209.601ms        18.51%           209.601ms        209.601ms
 NaN              0.000us          0.000us          1                []
unsigned short         7.08%            80.134ms         7.08%            80.134ms         80.134ms
 NaN              0.000us          0.000us          1                []
view                   6.98%            79.079ms         6.98%            79.079ms         79.079ms
 NaN              0.000us          0.000us          1                []
view                   6.58%            74.502ms         6.58%            74.502ms         74.502ms
 NaN              0.000us          0.000us          1                []
mm                     4.42%            50.019ms         4.42%            50.019ms         50.019ms
 NaN              0.000us          0.000us          1                []
leaky_relu             3.92%            44.409ms         3.92%            44.409ms         44.409ms
 NaN              0.000us          0.000us          1                []
to                     3.65%            41.347ms         3.65%            41.347ms         41.347ms
 NaN              0.000us          0.000us          1                []
conv1d                 2.17%            24.539ms         2.17%            24.539ms         24.539ms
 NaN              0.000us          0.000us          1                []
convolution            2.11%            23.919ms         2.11%            23.919ms         23.919ms
 NaN              0.000us          0.000us          1                []
_convolution           2.10%            23.763ms         2.10%            23.763ms         23.763ms
 NaN              0.000us          0.000us          1                []
cudnn_convolution      1.86%            21.087ms         1.86%            21.087ms         21.087ms
 NaN              0.000us          0.000us          1                []
contiguous             1.86%            21.055ms         1.86%            21.055ms         21.055ms
 NaN              0.000us          0.000us          1                []
add                    1.73%            19.606ms         1.73%            19.606ms         19.606ms
 NaN              0.000us          0.000us          1                []
matmul                 1.34%            15.204ms         1.34%            15.204ms         15.204ms
 NaN              0.000us          0.000us          1                []
---------------------  ---------------  ---------------  ---------------  ---------------  ---------------
 ---------------  ---------------  ---------------  ---------------  -----------------------------------
Self CPU time total: 1.132s
CUDA time total: 0.000us

--------------------------------------------------------------------------------
  autograd profiler output (CUDA mode)
--------------------------------------------------------------------------------
        top 15 events sorted by cpu_time_total

        Because the autograd profiler uses the CUDA event API,
        the CUDA time column reports approximately max(cuda_time, cpu_time).
        Please ignore this output if your code does not use CUDA.

------------------  ---------------  ---------------  ---------------  ---------------  ---------------  --
-------------  ---------------  ---------------  ---------------  -----------------------------------
Name                Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     C
UDA total %     CUDA total       CUDA time avg    Number of Calls  Input Shapes
------------------  ---------------  ---------------  ---------------  ---------------  ---------------  --
-------------  ---------------  ---------------  ---------------  -----------------------------------
uniform_            16.36%           261.335ms        16.36%           261.335ms        261.335ms        16
.38%           261.349ms        261.349ms        1                []
conv1d              13.48%           215.442ms        13.48%           215.442ms        215.442ms        13
.49%           215.144ms        215.144ms        1                []
convolution         13.05%           208.474ms        13.05%           208.474ms        208.474ms        13
.04%           208.024ms        208.024ms        1                []
_convolution        12.51%           199.817ms        12.51%           199.817ms        199.817ms        12
.49%           199.192ms        199.192ms        1                []
contiguous          8.73%            139.427ms        8.73%            139.427ms        139.427ms        8.
69%            138.704ms        138.704ms        1                []
empty_like          7.11%            113.534ms        7.11%            113.534ms        113.534ms        7.
10%            113.256ms        113.256ms        1                []
empty               5.70%            91.135ms         5.70%            91.135ms         91.135ms         5.
70%            90.888ms         90.888ms         1                []
scalar_tensor       4.80%            76.661ms         4.80%            76.661ms         76.661ms         4.
78%            76.336ms         76.336ms         1                []
unsigned short      3.95%            63.104ms         3.95%            63.104ms         63.104ms         3.
97%            63.400ms         63.400ms         1                []
scalar_tensor       2.48%            39.562ms         2.48%            39.562ms         39.562ms         2.
48%            39.568ms         39.568ms         1                []
empty               2.47%            39.479ms         2.47%            39.479ms         39.479ms         2.
48%            39.504ms         39.504ms         1                []
fill_               2.39%            38.138ms         2.39%            38.138ms         38.138ms         2.
40%            38.272ms         38.272ms         1                []
scalar_tensor       2.33%            37.298ms         2.33%            37.298ms         37.298ms         2.
34%            37.296ms         37.296ms         1                []
empty               2.33%            37.231ms         2.33%            37.231ms         37.231ms         2.
33%            37.248ms         37.248ms         1                []
conv1d              2.33%            37.202ms         2.33%            37.202ms         37.202ms         2.
33%            37.184ms         37.184ms         1                []
------------------  ---------------  ---------------  ---------------  ---------------  ---------------  --
-------------  ---------------  ---------------  ---------------  -----------------------------------
Self CPU time total: 1.598s
CUDA time total: 1.595s

(msn) [zhangjunzhe@SG-IDC1-10-51-0-103 pcd_lib]$






